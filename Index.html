<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PawMatch - Encuentra la pareja perfecta para tu perro</title>
    <style>
        :root {
            --primary: #FF8A00;
            --secondary: #5EAAE2;
            --light: #F8F9FA;
            --dark: #343A40;
            --success: #28A745;
            --danger: #DC3545;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: var(--dark);
        }
        
        .container {
            max-width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Login Screen */
        #login-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: var(--secondary);
            text-align: center;
            padding: 20px;
        }

        #login-screen h1 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        #login-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
            max-width: 300px;
        }

        #login-form input {
            padding: 12px;
            border-radius: 8px;
            border: none;
            font-size: 1rem;
        }

        #login-form button {
            padding: 12px;
            border: none;
            border-radius: 8px;
            background-color: var(--primary);
            color: white;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        #login-form button:hover {
            background-color: #e67e00;
        }

        #login-message {
            margin-top: 10px;
            color: white;
            font-weight: bold;
        }
        
        /* App UI */
        #app-ui {
            display: none; /* Oculto por defecto */
            flex: 1;
            flex-direction: column;
        }

        header {
            background-color: white;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        .logo span {
            color: var(--secondary);
        }
        
        nav ul {
            display: flex;
            list-style: none;
        }
        
        nav ul li {
            margin-left: 20px;
        }
        
        nav ul li a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
        }
        
        main {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        .dog-card-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .dog-card {
            width: 100%;
            max-width: 400px;
            height: 75vh;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            position: relative;
            transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out;
        }
        
        .dog-image {
            height: 70%;
            background-size: cover;
            background-position: center;
        }
        
        .dog-info {
            padding: 20px;
        }
        
        .dog-info h2 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .dog-info p {
            color: #666;
            margin-bottom: 5px;
        }
        
        .dog-tags {
            display: flex;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        
        .tag {
            background: var(--light);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-right: 5px;
            margin-bottom: 5px;
        }
        
        .actions {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        
        .action-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .dislike {
            background: white;
            color: var(--danger);
        }
        
        .like {
            background: white;
            color: var(--success);
        }
        
        .super-like {
            background: var(--secondary);
            color: white;
        }
        
        .bottom-nav {
            background: white;
            padding: 15px;
            display: flex;
            justify-content: space-around;
            box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: #888;
        }
        
        .nav-item.active {
            color: var(--primary);
        }
        
        .nav-icon {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
            text-align: center;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .close {
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .modal-content button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            width: 100%;
            margin-top: 15px;
            cursor: pointer;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .dog-card {
                height: 65vh;
            }
            
            nav ul {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div id="login-screen">
        <h1 class="logo">Paw<span>Match</span></h1>
        <p>Encuentra a su compa√±ero perfecto</p>
        <form id="login-form">
            <input type="password" id="password" placeholder="Ingresa tu contrase√±a" required>
            <button type="submit">Entrar</button>
        </form>
        <p id="login-message"></p>
    </div>

    <div id="app-ui">
        <header>
            <div class="logo">Paw<span>Match</span></div>
            <nav>
                <ul>
                    <li><a href="#">Descubrir</a></li>
                    <li><a href="#">Matches</a></li>
                    <li><a href="#">Mensajes</a></li>
                    <li><a href="#">Perfil</a></li>
                </ul>
            </nav>
        </header>
        
        <main>
            <div class="dog-card-container">
                <div class="dog-card">
                    <div class="dog-image"></div>
                    <div class="dog-info">
                        <h2>Cargando...</h2>
                        <p></p>
                        <div class="dog-tags"></div>
                    </div>
                    <div class="actions">
                        <button class="action-btn dislike">‚úñ</button>
                        <button class="action-btn like">‚ù§</button>
                    </div>
                </div>
            </div>
        </main>
        
        <div class="bottom-nav">
            <a href="#" class="nav-item active">
                <div class="nav-icon">üêæ</div>
                <span>Descubrir</span>
            </a>
            <a href="#" class="nav-item">
                <div class="nav-icon">üíå</div>
                <span>Matches</span>
            </a>
            <a href="#" class="nav-item">
                <div class="nav-icon">üí¨</div>
                <span>Mensajes</span>
            </a>
            <a href="#" class="nav-item">
                <div class="nav-icon">üë§</div>
                <span>Perfil</span>
            </a>
        </div>
    </div>
    
    <div class="modal" id="matchModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>¬°Es un match!</h2>
                <span class="close">&times;</span>
            </div>
            <p>¬°Enhorabuena! Has hecho match con <span id="match-pet-name"></span>. Ahora pod√©is chatear.</p>
            <button>Enviar mensaje</button>
        </div>
    </div>

    <script>
        const APPSCRIPT_URL = 'https://script.google.com/macros/library/d/1e-xNruU2vtL23ZNg9d3uyH1HYhmtVQ9eoevCF_s-xXPo1Nnqu5V9c8vA/1'; // <--- Pega tu URL aqu√≠
        
        const loginScreen = document.getElementById('login-screen');
        const appUI = document.getElementById('app-ui');
        const loginForm = document.getElementById('login-form');
        const passwordInput = document.getElementById('password');
        const loginMessage = document.getElementById('login-message');

        const dogCard = document.querySelector('.dog-card');
        const dogImage = document.querySelector('.dog-image');
        const dogName = document.querySelector('.dog-info h2');
        const dogInfo = document.querySelector('.dog-info p');
        const dogTags = document.querySelector('.dog-tags');
        const likeBtn = document.querySelector('.like');
        const dislikeBtn = document.querySelector('.dislike');
        
        const matchModal = document.getElementById('matchModal');
        const closeModal = document.querySelector('.close');
        const matchPetName = document.getElementById('match-pet-name');

        let dogs = [];
        let currentDogIndex = 0;
        let currentUser = 'Usuario1'; // Se podr√≠a obtener de una base de datos m√°s compleja

        // --- FUNCIONES DE AUTENTICACI√ìN Y CARGA DE DATOS ---

        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const password = passwordInput.value;
            loginMessage.textContent = 'Verificando...';

            try {
                const response = await fetch(APPSCRIPT_URL, {
                    method: 'POST',
                    body: JSON.stringify({ action: 'login', password: password }),
                    headers: { 'Content-Type': 'application/json' }
                });
                const result = await response.json();

                if (result.success) {
                    loginMessage.textContent = '¬°Acceso concedido!';
                    loginScreen.style.display = 'none';
                    appUI.style.display = 'flex';
                    await fetchDogs();
                } else {
                    loginMessage.textContent = 'Contrase√±a incorrecta. Intenta de nuevo.';
                }
            } catch (error) {
                console.error('Error de login:', error);
                loginMessage.textContent = 'Error al conectar. Intenta de nuevo m√°s tarde.';
            }
        });

        async function fetchDogs() {
            try {
                const response = await fetch(`${APPSCRIPT_URL}?action=getDogs`);
                const result = await response.json();
                dogs = result;
                if (dogs.length > 0) {
                    loadNewDog();
                } else {
                    dogName.textContent = 'No hay mascotas disponibles.';
                    dogInfo.textContent = '';
                    dogTags.innerHTML = '';
                    dogImage.style.backgroundImage = 'none';
                }
            } catch (error) {
                console.error('Error al cargar las mascotas:', error);
                dogName.textContent = 'Error al cargar los datos.';
            }
        }
        
        function loadNewDog() {
            if (currentDogIndex >= dogs.length) {
                dogCard.style.display = 'none';
                dogName.textContent = 'No hay m√°s mascotas en este momento.';
                return;
            }

            const currentDog = dogs[currentDogIndex];
            dogName.textContent = currentDog.Nombre;
            dogInfo.innerHTML = `${currentDog.Raza} ¬∑ ${currentDog.Edad}<br>A ${currentDog.Distancia} de distancia`;
            dogImage.style.backgroundImage = `url('${currentDog.ImagenURL}')`;
            
            dogTags.innerHTML = '';
            const tags = currentDog.Tags.split(',').map(tag => tag.trim());
            tags.forEach(tagText => {
                const tagSpan = document.createElement('span');
                tagSpan.className = 'tag';
                tagSpan.textContent = tagText;
                dogTags.appendChild(tagSpan);
            });

            dogCard.style.transform = '';
            dogCard.style.opacity = '1';
        }

        async function logAction(action) {
            if (currentDogIndex < dogs.length) {
                const currentDog = dogs[currentDogIndex];
                try {
                    await fetch(APPSCRIPT_URL, {
                        method: 'POST',
                        body: JSON.stringify({
                            action: 'logAction',
                            usuario: currentUser,
                            mascotaID: currentDog.ID,
                            accion: action
                        }),
                        headers: { 'Content-Type': 'application/json' }
                    });
                } catch (error) {
                    console.error('Error al registrar la acci√≥n:', error);
                }
            }
        }

        // --- L√ìGICA DE LA APP ---

        likeBtn.addEventListener('click', () => {
            logAction('Like');
            dogCard.style.transform = 'translateX(1000px) rotate(30deg)';
            dogCard.style.opacity = '0';
            
            // Simulaci√≥n de match aleatorio
            if (Math.random() > 0.5) {
                setTimeout(() => {
                    matchPetName.textContent = dogs[currentDogIndex].Nombre;
                    matchModal.style.display = 'flex';
                }, 500);
            }
            
            setTimeout(() => {
                currentDogIndex++;
                loadNewDog();
            }, 1000);
        });

        dislikeBtn.addEventListener('click', () => {
            logAction('Dislike');
            dogCard.style.transform = 'translateX(-1000px) rotate(-30deg)';
            dogCard.style.opacity = '0';
            
            setTimeout(() => {
                currentDogIndex++;
                loadNewDog();
            }, 1000);
        });
        
        closeModal.addEventListener('click', () => {
            matchModal.style.display = 'none';
        });

    </script>
</body>
</html>